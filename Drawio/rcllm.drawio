<mxfile host="65bd71144e">
    <diagram id="ZGTI720Jdrd9kXOFQsc5" name="第 1 页">
        <mxGraphModel dx="-1496" dy="1847" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="2" style="edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="5" target="9">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="3412" y="-411.75" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="3" style="edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="5" target="11">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="4" style="edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="5" target="14">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="5" value="qkv: torch.Size([num_imp_token, 6144])" style="text;whiteSpace=wrap;" vertex="1" parent="1">
                    <mxGeometry x="3317.5" y="-462.75" width="234.5" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="6" style="edgeStyle=none;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="7" target="5">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="7" value="hidden_states: torch.Size([num_imp_token, 4096])" style="text;whiteSpace=wrap;" vertex="1" parent="1">
                    <mxGeometry x="3287" y="-521.75" width="294" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="8" style="edgeStyle=none;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9" target="16">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="3412.5" y="-361.75" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="9" value="q: torch.Size([num_imp_token, 4096])" style="text;whiteSpace=wrap;align=center;verticalAlign=middle;" vertex="1" parent="1">
                    <mxGeometry x="3319.5" y="-402.75" width="230.5" height="24" as="geometry"/>
                </mxCell>
                <mxCell id="10" style="edgeStyle=none;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="11" target="34">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="3668" y="-348" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="11" value="k: torch.Size([num_imp_token, 1024])" style="text;whiteSpace=wrap;align=center;verticalAlign=middle;" vertex="1" parent="1">
                    <mxGeometry x="3550" y="-402.75" width="231.5" height="24" as="geometry"/>
                </mxCell>
                <mxCell id="12" style="edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="35" target="20">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="13" style="edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="14" target="35">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="14" value="v: torch.Size([num_imp_token, 1024])" style="text;whiteSpace=wrap;align=center;verticalAlign=middle;" vertex="1" parent="1">
                    <mxGeometry x="3793" y="-402.75" width="233" height="24" as="geometry"/>
                </mxCell>
                <mxCell id="15" style="edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="16" target="20">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="16" value="q: torch.Size([num_imp_token, 4096])" style="text;whiteSpace=wrap;align=center;verticalAlign=middle;fontStyle=1" vertex="1" parent="1">
                    <mxGeometry x="3322.0299999999997" y="-267" width="225.44" height="24" as="geometry"/>
                </mxCell>
                <mxCell id="17" style="edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="18" target="20">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="3596.8023255813955" y="-311.75" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="18" value="k: torch.Size([prompt_len, 1024])" style="text;whiteSpace=wrap;align=center;verticalAlign=middle;fontStyle=1" vertex="1" parent="1">
                    <mxGeometry x="3554" y="-267" width="225" height="24" as="geometry"/>
                </mxCell>
                <mxCell id="19" style="edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="20" target="22">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="20" value="attention calculate" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="3589" y="-197" width="155" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="21" style="edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="22" target="32">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="22" value="attn_output: torch.Size([num_imp_token, 4096])" style="text;whiteSpace=wrap;align=center;verticalAlign=middle;" vertex="1" parent="1">
                    <mxGeometry x="3523.84" y="-138" width="285.31" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="23" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;" vertex="1" parent="1">
                    <mxGeometry x="3252" y="-496.75" width="20" height="46" as="geometry"/>
                </mxCell>
                <mxCell id="24" value="get qkv" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
                    <mxGeometry x="3195" y="-486.75" width="57" height="26" as="geometry"/>
                </mxCell>
                <mxCell id="25" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;" vertex="1" parent="1">
                    <mxGeometry x="3284" y="-442.75" width="20" height="46" as="geometry"/>
                </mxCell>
                <mxCell id="26" value="qkv spilt" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
                    <mxGeometry x="3225" y="-432.75" width="61" height="26" as="geometry"/>
                </mxCell>
                <mxCell id="27" value="" style="shape=ext;double=1;rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="3589" y="-640" width="322" height="82" as="geometry"/>
                </mxCell>
                <mxCell id="28" value="4096 : num_head ( 32 )&amp;nbsp;* head_size ( 128 )" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
                    <mxGeometry x="3640" y="-630" width="250" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="29" value="1024 : num_kv_head ( 8 )&amp;nbsp;* head_size ( 128 )" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
                    <mxGeometry x="3640" y="-600" width="260" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="30" value="GQA:" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
                    <mxGeometry x="3597" y="-615" width="50" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="31" style="edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="32" target="7">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="3425" y="-545" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="3667" y="-27"/>
                            <mxPoint x="3162" y="-35"/>
                            <mxPoint x="3160" y="-587"/>
                            <mxPoint x="3432" y="-587"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="32" value="mlp" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="3588.25" y="-86" width="155" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="33" style="edgeStyle=none;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="34" target="18">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="34" value="k: torch.Size([num_imp_token, 1024])" style="text;whiteSpace=wrap;align=center;verticalAlign=middle;fontStyle=1" vertex="1" parent="1">
                    <mxGeometry x="3553.25" y="-331.5" width="225" height="24" as="geometry"/>
                </mxCell>
                <mxCell id="35" value="v: torch.Size([prompt_len, 1024])" style="text;whiteSpace=wrap;align=center;verticalAlign=middle;fontStyle=1" vertex="1" parent="1">
                    <mxGeometry x="3793" y="-334" width="233" height="24" as="geometry"/>
                </mxCell>
                <mxCell id="36" style="edgeStyle=entityRelationEdgeStyle;html=1;startArrow=none;endArrow=none;segment=10;curved=1;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" edge="1" parent="1" source="37">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="3663.666666666667" y="-354" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="37" value="rope" style="whiteSpace=wrap;html=1;rounded=1;arcSize=50;align=center;verticalAlign=middle;strokeWidth=1;autosize=1;spacing=4;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1,&quot;sourcePerimeterSpacing&quot;:0,&quot;targetPerimeterSpacing&quot;:0};fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
                    <mxGeometry x="3504" y="-366" width="63" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="38" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" edge="1" parent="1" target="37">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="3435" y="-327" as="sourcePoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="39" style="edgeStyle=entityRelationEdgeStyle;html=1;startArrow=none;endArrow=none;segment=10;curved=1;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="40">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="3909.5" y="-358" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="40" value="update&lt;div&gt;old_kv&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;arcSize=50;align=center;verticalAlign=middle;strokeWidth=1;autosize=1;spacing=4;treeFolding=1;treeMoving=1;newEdgeStyle={&quot;edgeStyle&quot;:&quot;entityRelationEdgeStyle&quot;,&quot;startArrow&quot;:&quot;none&quot;,&quot;endArrow&quot;:&quot;none&quot;,&quot;segment&quot;:10,&quot;curved&quot;:1,&quot;sourcePerimeterSpacing&quot;:0,&quot;targetPerimeterSpacing&quot;:0};fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
                    <mxGeometry x="3748" y="-379" width="76" height="45" as="geometry"/>
                </mxCell>
                <mxCell id="41" value="" style="edgeStyle=entityRelationEdgeStyle;startArrow=none;endArrow=none;segment=10;curved=1;sourcePerimeterSpacing=0;targetPerimeterSpacing=0;" edge="1" parent="1" target="40">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="3667" y="-291" as="sourcePoint"/>
                        <Array as="points">
                            <mxPoint x="3732" y="-372.75"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>